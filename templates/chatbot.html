<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DR.URCW Bot</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --primary:#2980b9;
  --bg:#f4f6f9;
  --card:#ffffff;
  --bot:#e3f2fd;
}
body{
  font-family:'Poppins',sans-serif;
  background:var(--bg);
}
.wrapper{
  display:flex;
  height:100vh;
}
.sidebar{
  width:260px;
  background:linear-gradient(180deg,#2c3e50,#2980b9);
  color:white;
  padding:25px;
}
.chat-area{
  flex:1;
  display:flex;
  flex-direction:column;
}
.chat-body{
  flex:1;
  padding:20px;
  overflow-y:auto;
}
.msg{
  max-width:70%;
  padding:12px 16px;
  border-radius:18px;
  margin-bottom:12px;
}
.user{
  background:var(--primary);
  color:white;
  align-self:flex-end;
}
.bot{
  background:var(--bot);
  align-self:flex-start;
}
.chat-input{
  padding:15px;
  background:var(--card);
  display:flex;
  gap:10px;
}
.chat-input input{
  border-radius:25px;
  padding:12px 15px;
}
</style>
</head>

<body>

<div class="wrapper">

  <!-- SIDEBAR -->
  <div class="sidebar">

  <!-- APP HEADER -->
  <div class="text-center mb-4">
    <img
      src="/static/Images_ss/college_logo.png"
      alt="DR.URCW Logo"
      style="width:70px; margin-bottom:10px;"
    >
    <h5 class="mb-0 fw-semibold">DR.URCW BOT</h5>
    <small style="opacity:0.8;">
      Dr. Umayal Ramanathan<br>
      College for Women
    </small>
  </div>

  <hr style="border-color:rgba(255,255,255,0.3);">

  <!-- USER INFO -->
  <div class="mb-3">
    <strong>{{ user.name }}</strong><br>
    <small style="opacity:0.85;">{{ user.email }}</small>
  </div>

  <!-- NAVIGATION -->
  <a href="/dashboard" class="btn btn-light btn-sm w-100 mb-2">
    Dashboard
  </a>

  <a href="/logout" class="btn btn-outline-light btn-sm w-100">
    Logout
  </a>

</div>


  <!-- CHAT -->
  <div class="chat-area">
    <div class="chat-body" id="chat">

    {% for msg in history %}
        <div class="msg {{ msg.sender }}">
        {{ msg.message | safe }}
        <div class="time">
            {{ msg.created_at.strftime('%H:%M') }}
        </div>
        </div>
    {% endfor %}

    </div>


    <form class="chat-input" id="chatForm">
      <input id="msg" class="form-control" placeholder="Type your question..." required>
      <button class="btn btn-primary">Send</button>
    </form>
  </div>

  

</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$("#chatForm").submit(function(e){
  e.preventDefault();
  let msg = $("#msg").val().trim();
  if(!msg) return;

  $("#chat").append(`<div class="msg user">${msg}</div>`);
  $("#msg").val("");

  $.post("/chat", {message: msg}, function(data){
    $("#chat").append(`<div class="msg bot">${data.reply}</div>`);
    $("#chat").scrollTop($("#chat")[0].scrollHeight);
  });
});
</script>

</body>
</html>
