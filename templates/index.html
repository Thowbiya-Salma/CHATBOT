<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CRCE Bot</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Bootstrap & Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#f4f6f9;
  --card:#ffffff;
  --bot:#e3f2fd;
  --user:#2980b9;
  --text:#000;
}
body.dark{
  --bg:#121212;
  --card:#1f1f1f;
  --bot:#2c3e50;
  --user:#3498db;
  --text:#fff;
}
body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:var(--bg);
  color:var(--text);
}

/* Layout */
.wrapper{
  display:flex;
  height:100vh;
}
.sidebar{
  width:260px;
  background:linear-gradient(180deg,#2c3e50,#2980b9);
  color:white;
  padding:20px;
}
.sidebar img{
  width:80px;
  margin-bottom:15px;
}
.sidebar h5{
  margin-top:10px;
}
.sidebar small{
  opacity:.8;
}
.toggle{
  margin-top:20px;
}

/* Chat */
.chat-area{
  flex:1;
  display:flex;
  flex-direction:column;
}
.chat-header{
  background:var(--card);
  padding:15px 20px;
  border-bottom:1px solid #ddd;
  display:flex;
  align-items:center;
  justify-content:space-between;
}
.chat-header img{
  width:45px;
  border-radius:50%;
}
.chat-body{
  flex:1;
  padding:20px;
  overflow-y:auto;
}
.msg{
  max-width:70%;
  margin-bottom:15px;
  padding:12px 16px;
  border-radius:18px;
  font-size:14px;
}
.bot{
  background:var(--bot);
  align-self:flex-start;
}
.user{
  background:var(--user);
  color:white;
  align-self:flex-end;
}
.time{
  font-size:11px;
  opacity:.6;
  margin-top:4px;
}

/* Input */
.chat-input{
  padding:15px;
  background:var(--card);
  display:flex;
  gap:10px;
}
.chat-input input{
  flex:1;
  border-radius:25px;
  padding:10px 15px;
}
.chat-input button{
  border-radius:25px;
}

/* Typing */
.typing{
  font-size:13px;
  opacity:.7;
  margin-bottom:10px;
}
</style>
</head>

<body>

<div class="wrapper">

  <!-- SIDEBAR -->
  <div class="sidebar">
    <img src="https://cdn-icons-png.flaticon.com/512/4712/4712109.png">
    <h5>CRCE BOT</h5>
    <small>Dr. Umayal Ramanathan<br>College for Women</small>

    <div class="toggle form-check form-switch mt-4">
      <input class="form-check-input" type="checkbox" id="darkToggle">
      <label class="form-check-label">Dark Mode</label>
    </div>

    <a href="/" class="btn btn-light btn-sm mt-4 w-100">Logout</a>
  </div>

  <!-- CHAT AREA -->
  <div class="chat-area">
    <div class="chat-header">
      <div class="d-flex align-items-center gap-2">
        <img src="https://cdn-icons-png.flaticon.com/512/4712/4712109.png">
        <div>
          <strong>CRCE Bot</strong><br>
          <small class="text-muted">Online</small>
        </div>
      </div>
    </div>

    <div class="chat-body" id="chat">
      <div class="msg bot">
        Hi üëã Welcome to <b>CRCE BOT</b><br><br>
        Choose one option:<br>
        1Ô∏è‚É£ Student Section<br>
        2Ô∏è‚É£ Faculty Section<br>
        3Ô∏è‚É£ Parent Section<br>
        4Ô∏è‚É£ Visitor Section
        <div class="time">now</div>
      </div>
    </div>

    <form class="chat-input" id="chatForm">
      <input id="msg" placeholder="Type 1, 1.1, hi..." required>
      <button class="btn btn-primary">Send</button>
    </form>
  </div>

</div>

<!-- JS -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
function timeNow(){
  const d=new Date();
  return d.getHours().toString().padStart(2,'0')+":"+d.getMinutes().toString().padStart(2,'0');
}

$("#chatForm").submit(function(e){
  e.preventDefault();
  let msg=$("#msg").val().trim();
  if(!msg) return;

  $("#chat").append(`<div class="msg user">${msg}<div class="time">${timeNow()}</div></div>`);
  $("#msg").val("");
  $("#chat").append(`<div class="typing" id="typing">CRCE Bot is typing...</div>`);
  $("#chat").scrollTop($("#chat")[0].scrollHeight);

  setTimeout(()=>{
    $.post("/chat",{message:msg},function(data){
      $("#typing").remove();
      $("#chat").append(`<div class="msg bot">${data.reply}<div class="time">${timeNow()}</div></div>`);
      $("#chat").scrollTop($("#chat")[0].scrollHeight);
    });
  },800);
});

// Dark mode
$("#darkToggle").change(function(){
  document.body.classList.toggle("dark");
});
</script>

</body>
</html>
